' Gambas class file


Public Sub Form_Show()

  Dim res As Result

GridView1.Columns.Count = 2
GridView1.Columns[0].Alignment = Align.Justify
GridView1.Columns[0].Title = "id"
GridView1.Columns[1].Alignment = Align.Center
GridView1.Columns[1].Title = "Category"

res = Global.DBconn.Find("types")
  GridView1.Clear
  GridView1.Rows.Count = res.Count
  
    For Each res
      GridView1[res.Index, 0].Text = res!id
      GridView1[res.Index, 1].Text = res!item
    Next

End

Public Sub TextBox1_Change()
' Dim res As Result
'   res = Global.DBconn.Find("types", "type LIKE &1", "%" & Textbox1.Text & "%")
'   For Each res
'     TextArea1.text = res!type & Chr(13)
'   Next

End

Public Sub Button1_Click()
Dim res As Result
  
  res = Global.DBconn.Create("types")
  res!item = Textbox1.Text
  res.Update  
  Global.DBconn.Commit
  
End

Public Sub Button3_Click()

  Me.Close

End

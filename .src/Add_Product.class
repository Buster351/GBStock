' Gambas class file

Public category_id As Integer
Public brand_id As Integer

Public filename As String

Public Sub Form_Show()

  Global.LoadCatagories(ComboBox1)
  Global.LoadBrands(ComboBox2)
  
End

Public Sub Button1_Click()

  Add_Category.ShowModal
  Global.LoadCatagories(ComboBox1)
  

End

Public Sub Button2_Click()
Dim res As Result
Dim type As Result
Dim brand As Result

  res = Global.DBconn.Create("products")
  type = Global.DBconn.Find("types", "item = &1", ComboBox1.Current.text)
  res!category = type!id
  brand = Global.DBconn.Find("brands", "item = &1", ComboBox2.Current.Text)
  res!brand = brand!id
  
  res!partnum = TextBox1.Text
  res!description = TextArea1.Text
  res!price = Val(TextBox2.Text)
  res!markup = SliderBox1.Value
  res!image = Global.LoadPictureFile(filename)
  res!barcode = TextBox3.Text
  res!date = Now
  res.Update
  Global.DBconn.Commit
  
  Me.Close
  

End

Public Sub Button3_Click()

  Add_Brand.ShowModal
  Global.LoadBrands(ComboBox2)

End



Public Sub PictureBox1_DblClick()

  Dialog.Filter = ["*.png;*.jpg;*.jpeg;*.bmp", "Picture files"]
  Dialog.FilterIndex = 0
  
  Dialog.Path = User.Home & "/Pictures"
  
  If Dialog.OpenFile() Then
    Return 
  Endif 
  filename = Dialog.Path 
  PictureBox1.Picture = Global.LoadScaled(filename, PictureBox1.Width, PictureBox1.Height, True)
End



Public Sub Button4_Click()

  Me.Close
  

End

Public Function GetCategoryid(comb As ComboBox, text As String) As Integer
  Dim res As Result
  
  
  
End

Public Sub Button5_Click()
Desktop.Open("https://www.google.com/search?tbm = isch&q=" & TextBox1.text)

  'web.ShowModal

End

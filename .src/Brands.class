' Gambas class file


Public Sub Form_Show()
Dim res As Result

GridView1.Columns.Count = 2
GridView1.Columns[0].Alignment = Align.Justify
GridView1.Columns[0].Title = "id"
GridView1.Columns[1].Alignment = Align.Center
GridView1.Columns[1].Title = "Brand"

res = Global.DBconn.Find("brands")
  GridView1.Clear
  GridView1.Rows.Count = res.Count
  
    For Each res
      GridView1[res.Index, 0].Text = res!id
      GridView1[res.Index, 1].Text = res!brand
    Next
End

Public Sub Button2_Click()

  Me.Close

End

Public Sub Button3_Click()

  Me.Close

End

Public Sub Button1_Click()
Dim res As Result
  res = Global.DBconn.Create("brands")
  res!brand = TextBox1.Text
  res!date = Now
  res.Update
  Global.DBconn.Commit
  
  res = Global.DBconn.Find("brands")
  GridView1.Clear
  GridView1.Rows.Count = res.Count
  
    For Each res
      GridView1[res.Index, 0].Text = res!id
      GridView1[res.Index, 1].Text = res!brand
    Next
End

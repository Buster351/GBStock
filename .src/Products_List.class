' Gambas class file


Public Sub Form_Show()
Dim res As Result
res = Global.DBconn.Find("products")
FillProductsGrid(res)  

End

Public Sub Button1_Click()

  Me.Close
  

End

Public Sub TextBox1_Change()
Dim res As Result

  If Len(TextBox1.text) > 2 Then 
    res = Global.SearchForMulti(TextBox1.text, ["partnum", "description"], "products")
    FillProductsGrid(res)
  Endif
End

Public Sub FillProductsGrid(res As Result)
  
  'Dim res As Result
  Dim brand As Result
  Dim type As Result
  
  
  GridView1.Clear
  GridView1.Columns.Count = 4
  
  GridView1.Rows.Count = res.Count
      
    For Each res
      GridView1[res.Index, 0].Text = res!id
      GridView1[res.Index, 1].text = res!partnum
      type = Global.DBconn.Find("types", "id= &1", res!category)
      If type.Available Then 
      GridView1[res.Index, 2].Text = type!item
      Endif 
      GridView1[res.Index, 3].text = res!description     
    Next
  
End
